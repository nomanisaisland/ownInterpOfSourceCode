{"ast":null,"code":"/**\r\n * Copyright (c) Facebook, Inc. and its affiliates.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n *\r\n * \r\n */\nimport { getInstanceFromNode, getFiberCurrentPropsFromNode } from '../client/ReactDOMComponentTree'; // Use to restore controlled state after a change event has fired.\n\nlet restoreImpl = null;\nlet restoreTarget = null;\nlet restoreQueue = null;\n\nfunction restoreStateOfTarget(target) {\n  // We perform this translation at the end of the event loop so that we\n  // always receive the correct fiber here\n  const internalInstance = getInstanceFromNode(target);\n\n  if (!internalInstance) {\n    // Unmounted\n    return;\n  }\n\n  if (typeof restoreImpl !== 'function') {\n    throw new Error('setRestoreImplementation() needs to be called to handle a target for controlled ' + 'events. This error is likely caused by a bug in React. Please file an issue.');\n  }\n\n  const stateNode = internalInstance.stateNode; // Guard against Fiber being unmounted.\n\n  if (stateNode) {\n    const props = getFiberCurrentPropsFromNode(stateNode);\n    restoreImpl(internalInstance.stateNode, internalInstance.type, props);\n  }\n}\n\nexport function setRestoreImplementation(impl) {\n  restoreImpl = impl;\n}\nexport function enqueueStateRestore(target) {\n  if (restoreTarget) {\n    if (restoreQueue) {\n      restoreQueue.push(target);\n    } else {\n      restoreQueue = [target];\n    }\n  } else {\n    restoreTarget = target;\n  }\n}\nexport function needsStateRestore() {\n  return restoreTarget !== null || restoreQueue !== null;\n}\nexport function restoreStateIfNeeded() {\n  if (!restoreTarget) {\n    return;\n  }\n\n  const target = restoreTarget;\n  const queuedTargets = restoreQueue;\n  restoreTarget = null;\n  restoreQueue = null;\n  restoreStateOfTarget(target);\n\n  if (queuedTargets) {\n    for (let i = 0; i < queuedTargets.length; i++) {\n      restoreStateOfTarget(queuedTargets[i]);\n    }\n  }\n}","map":{"version":3,"names":["getInstanceFromNode","getFiberCurrentPropsFromNode","restoreImpl","restoreTarget","restoreQueue","restoreStateOfTarget","target","internalInstance","Error","stateNode","props","type","setRestoreImplementation","impl","enqueueStateRestore","push","needsStateRestore","restoreStateIfNeeded","queuedTargets","i","length"],"sources":["D:/project/font-end/debug-anything/react-test/src/react/packages/react-dom/src/events/ReactDOMControlledComponent.js"],"sourcesContent":["/**\r\n * Copyright (c) Facebook, Inc. and its affiliates.\r\n *\r\n * This source code is licensed under the MIT license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n *\r\n * @flow\r\n */\r\n\r\nimport {\r\n  getInstanceFromNode,\r\n  getFiberCurrentPropsFromNode,\r\n} from '../client/ReactDOMComponentTree';\r\n\r\n// Use to restore controlled state after a change event has fired.\r\n\r\nlet restoreImpl = null;\r\nlet restoreTarget = null;\r\nlet restoreQueue = null;\r\n\r\nfunction restoreStateOfTarget(target: Node) {\r\n  // We perform this translation at the end of the event loop so that we\r\n  // always receive the correct fiber here\r\n  const internalInstance = getInstanceFromNode(target);\r\n  if (!internalInstance) {\r\n    // Unmounted\r\n    return;\r\n  }\r\n\r\n  if (typeof restoreImpl !== 'function') {\r\n    throw new Error(\r\n      'setRestoreImplementation() needs to be called to handle a target for controlled ' +\r\n        'events. This error is likely caused by a bug in React. Please file an issue.',\r\n    );\r\n  }\r\n\r\n  const stateNode = internalInstance.stateNode;\r\n  // Guard against Fiber being unmounted.\r\n  if (stateNode) {\r\n    const props = getFiberCurrentPropsFromNode(stateNode);\r\n    restoreImpl(internalInstance.stateNode, internalInstance.type, props);\r\n  }\r\n}\r\n\r\nexport function setRestoreImplementation(\r\n  impl: (domElement: Element, tag: string, props: Object) => void,\r\n): void {\r\n  restoreImpl = impl;\r\n}\r\n\r\nexport function enqueueStateRestore(target: Node): void {\r\n  if (restoreTarget) {\r\n    if (restoreQueue) {\r\n      restoreQueue.push(target);\r\n    } else {\r\n      restoreQueue = [target];\r\n    }\r\n  } else {\r\n    restoreTarget = target;\r\n  }\r\n}\r\n\r\nexport function needsStateRestore(): boolean {\r\n  return restoreTarget !== null || restoreQueue !== null;\r\n}\r\n\r\nexport function restoreStateIfNeeded() {\r\n  if (!restoreTarget) {\r\n    return;\r\n  }\r\n  const target = restoreTarget;\r\n  const queuedTargets = restoreQueue;\r\n  restoreTarget = null;\r\n  restoreQueue = null;\r\n\r\n  restoreStateOfTarget(target);\r\n  if (queuedTargets) {\r\n    for (let i = 0; i < queuedTargets.length; i++) {\r\n      restoreStateOfTarget(queuedTargets[i]);\r\n    }\r\n  }\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,SACEA,mBADF,EAEEC,4BAFF,QAGO,iCAHP,C,CAKA;;AAEA,IAAIC,WAAW,GAAG,IAAlB;AACA,IAAIC,aAAa,GAAG,IAApB;AACA,IAAIC,YAAY,GAAG,IAAnB;;AAEA,SAASC,oBAAT,CAA8BC,MAA9B,EAA4C;EAC1C;EACA;EACA,MAAMC,gBAAgB,GAAGP,mBAAmB,CAACM,MAAD,CAA5C;;EACA,IAAI,CAACC,gBAAL,EAAuB;IACrB;IACA;EACD;;EAED,IAAI,OAAOL,WAAP,KAAuB,UAA3B,EAAuC;IACrC,MAAM,IAAIM,KAAJ,CACJ,qFACE,8EAFE,CAAN;EAID;;EAED,MAAMC,SAAS,GAAGF,gBAAgB,CAACE,SAAnC,CAhB0C,CAiB1C;;EACA,IAAIA,SAAJ,EAAe;IACb,MAAMC,KAAK,GAAGT,4BAA4B,CAACQ,SAAD,CAA1C;IACAP,WAAW,CAACK,gBAAgB,CAACE,SAAlB,EAA6BF,gBAAgB,CAACI,IAA9C,EAAoDD,KAApD,CAAX;EACD;AACF;;AAED,OAAO,SAASE,wBAAT,CACLC,IADK,EAEC;EACNX,WAAW,GAAGW,IAAd;AACD;AAED,OAAO,SAASC,mBAAT,CAA6BR,MAA7B,EAAiD;EACtD,IAAIH,aAAJ,EAAmB;IACjB,IAAIC,YAAJ,EAAkB;MAChBA,YAAY,CAACW,IAAb,CAAkBT,MAAlB;IACD,CAFD,MAEO;MACLF,YAAY,GAAG,CAACE,MAAD,CAAf;IACD;EACF,CAND,MAMO;IACLH,aAAa,GAAGG,MAAhB;EACD;AACF;AAED,OAAO,SAASU,iBAAT,GAAsC;EAC3C,OAAOb,aAAa,KAAK,IAAlB,IAA0BC,YAAY,KAAK,IAAlD;AACD;AAED,OAAO,SAASa,oBAAT,GAAgC;EACrC,IAAI,CAACd,aAAL,EAAoB;IAClB;EACD;;EACD,MAAMG,MAAM,GAAGH,aAAf;EACA,MAAMe,aAAa,GAAGd,YAAtB;EACAD,aAAa,GAAG,IAAhB;EACAC,YAAY,GAAG,IAAf;EAEAC,oBAAoB,CAACC,MAAD,CAApB;;EACA,IAAIY,aAAJ,EAAmB;IACjB,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,aAAa,CAACE,MAAlC,EAA0CD,CAAC,EAA3C,EAA+C;MAC7Cd,oBAAoB,CAACa,aAAa,CAACC,CAAD,CAAd,CAApB;IACD;EACF;AACF"},"metadata":{},"sourceType":"module"}